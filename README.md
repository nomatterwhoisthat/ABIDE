# Методологическая оценка применения машинного обучения для классификации людей с нейрокогнитивными особенностями по данным функциональной связности мозга

Научно-исследовательская работа, посвященная критическому анализу методологии применения машинного обучения к данным функциональной МРТ.

## Описание проекта

Данный проект содержит реализацию и анализ пайплайнов машинного обучения для бинарной классификации участников с нейрокогнитивными особенностями и контрольной группы на основе данных функциональной связности мозга из набора данных ABIDE I.

Основной фокус работы — **методологический анализ** и выявление проблем воспроизводимости, связанных с утечкой данных и процедурами валидации в исследованиях нейровизуализации.

## Задачи исследования

1. Реализация и адаптация репрезентативных пайплайнов машинного обучения с контролем переобучения
2. Всесторонняя экспериментальная оценка моделей с акцентом на стабильность метрик
3. Критический анализ факторов, ограничивающих обобщающую способность моделей
4. Формулировка практических рекомендаций по методологии для повышения достоверности результатов



## Набор данных

Используется набор данных **ABIDE I** (Autism Brain Imaging Data Exchange):
- 871 участник (403 с нейрокогнитивными особенностями, 468 контрольная группа)
- 20 международных центров сбора данных
- Матрицы функциональной связности 116×116 (AAL атлас)
- 6670 признаков на участника после векторизации

Предобработка выполнена с помощью пайплайна CPAC (Configurable Pipeline for the Analysis of Connectomes).

## Реализованные модели

### Пайплайн 1 (Первоначальный)
- **Сильно регуляризованная логистическая регрессия**
- **LightGBM** с экстремальными параметрами регуляризации
- **Ансамбль** (усреднение вероятностей)
- **Метод отбора признаков**: стабильный отбор на основе трёх типов регуляризации

### Пайплайн 2 (Исправленный, без data leakage)
- Вложенная кросс-валидация (StratifiedGroupKFold)
- Изоляция всех этапов предобработки внутри фолдов
- Строгое разделение train/val/test на каждом фолде
- Расширенный набор метрик оценки

##  Ключевые результаты

### Первоначальный пайплайн (с data leakage):

| Модель | AUC | Accuracy | F1-score | ΔAUC |
|--------|-----|----------|----------|------|
| Logistic Regression | 0.786 | 0.706 | 0.724 | 0.039 |
| LightGBM | 0.712 | 0.620 | 0.680 | 0.180 |
| Ансамбль | 0.787 | 0.712 | 0.724 | 0.056 |

### Исправленный пайплайн (без data leakage):

| Модель | AUC | Accuracy | F1-score | ΔAUC |
|--------|-----|----------|----------|------|
| Logistic Regression | 0.671±0.078 | 0.610±0.049 | 0.616±0.106 | 0.154 |
| LightGBM | 0.634±0.064 | 0.529±0.060 | 0.625±0.061 | 0.237 |
| Ансамбль | 0.670±0.077 | 0.607±0.050 | 0.621±0.095 | 0.164 |

##  Основные выводы

1. **Утечка данных** в процедуре отбора признаков приводит к значительному завышению метрик качества (AUC снизился с 0.787 до 0.671 после исправления).

2. **Классические методы машинного обучения** показывают ограниченную эффективность для данной задачи (AUC ≈ 0.67, близко к случайному уровню).

3. **Мультицентровость данных** создает существенные трудности для построения устойчивых моделей (высокая вариабельность между фолдами).

4. **Сильное переобучение** наблюдается даже при использовании экстремальных параметров регуляризации.

##  Направления для будущих исследований

1. **Стратифицированный анализ** — построение отдельных моделей для однородных подгрупп (по возрасту, полу)
2. **Коррекция межсайтовых различий** — применение методов типа ComBat
3. **Более сложные архитектуры** — графовые нейросети, методы глубокого обучения
4. **Мультимодальная интеграция** — комбинирование функциональных и структурных данных

##  Быстрый старт

1. **Клонируйте репозиторий:**
```bash
git clone https://github.com/nomatterwhoisthat/ABIDE
cd ABIDE
```


2. **Запустите ноутбуки в порядке:**
```bash
jupyter notebook data_loading.ipynb
jupyter notebook first_experiment.ipynb  
jupyter notebook second_experiment.ipynb
```
